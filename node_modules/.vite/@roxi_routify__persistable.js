import {
  fs_exports,
  init_fs,
  init_path,
  path_exports
} from "./chunk-MAUNEH5Z.js";
import {
  __commonJS,
  __toCommonJS
} from "./chunk-ICLR7M5L.js";

// node_modules/persistable/lib/utils.js
var require_utils = __commonJS({
  "node_modules/persistable/lib/utils.js"(exports, module) {
    var stringHashCode = (str) => str.split("").reduce((a, b) => {
      a = (a << 5) - a + b.charCodeAt(0);
      return a & a;
    }, 0).toString(36);
    var fnToName = (fn) => {
      const fnStr = fn.toString();
      const length = fnStr.length;
      const snippet = fnStr.replace(/[^\w]/gm, "_").replace(/\_+/gm, "_").replace(/^\_/, "").slice(0, 20);
      return snippet + "-" + length + "-" + stringHashCode(fnStr);
    };
    module.exports = { fnToName };
  }
});

// node_modules/persistable/lib/index.js
var require_lib = __commonJS({
  "node_modules/persistable/lib/index.js"(exports, module) {
    var { existsSync, writeFileSync, mkdirSync, readFileSync } = (init_fs(), __toCommonJS(fs_exports));
    var { resolve } = (init_path(), __toCommonJS(path_exports));
    var { fnToName } = require_utils();
    var defaults = {
      outputDir: "persistable",
      minify: false
    };
    var persistable = (options = {}) => {
      options = Object.assign(defaults, options);
      const persist = async (callback, refresh, name) => {
        name = name || fnToName(callback);
        const filepath = resolve(persist.outputDir, name + ".json");
        if (!existsSync(filepath) || refresh) {
          mkdirSync(persist.outputDir, { recursive: true });
          const value = await callback();
          const stamp = { value, updated: new Date() };
          writeFileSync(filepath, JSON.stringify(stamp, null, persist.minify ? 0 : 2));
        }
        return JSON.parse(readFileSync(filepath, "utf-8")).value;
      };
      Object.assign(persist, options);
      return persist;
    };
    module.exports = persistable;
  }
});

// dep:@roxi_routify__persistable
var roxi_routify_persistable_default = require_lib();
export {
  roxi_routify_persistable_default as default
};
//# sourceMappingURL=@roxi_routify__persistable.js.map
