{
  "version": 3,
  "sources": ["../hookar/index.js"],
  "sourcesContent": ["\n\n/**\n * @template H\n * @callback AddHookToCollection\n * @param {H} hook\n * @returns {function} unhook\n **/\n\n/**\n * @template H\n * @typedef {AddHookToCollection<H> & HooksCollectionProps<H>} HooksCollection\n */\n\n/**\n * @template H hook\n * @typedef {Object} HooksCollectionProps\n * @prop {H} run\n * @prop {H[]} hooks\n */\n\n/**\n * creates a hook collection\n * @template H\n * @return {HooksCollection<H>}\n * @example\n * const hooksCollection = createHook()\n * const unhookFn = hooksCollection(x => console.log('hello', x))\n * const unhookFn2 = hooksCollection(x => console.log('goodbye', x))\n *\n * // call hooks\n * hooksCollection.hooks.forEach(hook => hook('Jake'))\n * // logs \"hello Jake\" and \"goodbye Jake\"\n *\n * // unregister\n * unhookFn()\n * unhookFn2()\n */\nconst createHooksCollection = (runner) => {\n    /** @type {H[]} */\n    const hooks = []\n\n    /**\n     *@type {HooksCollection<H>}\n     */\n    const hooksCollection = hook => {\n        hooks.push(hook)\n        return () => hooks.splice(hooks.indexOf(hook), 1)\n    }\n\n    hooksCollection.hooks = hooks\n    hooksCollection.run = runner(hooks)\n\n    return hooksCollection\n}\n\n\n\n/**\n * @template P\n * @typedef {HooksCollection<(pri: P, ...rest)=>P>} CollectionSync\n */\n/**\n * @template P\n * @typedef {HooksCollection<(pri: P, ...rest)=>P|Promise<P>>} CollectionAsync\n */\n/**\n * @template P\n * @typedef {HooksCollection<((pri: P, ...rest)=>void)>} CollectionSyncVoid\n */\n/**\n * @template P\n * @typedef {HooksCollection<(pri: P, ...rest)=>void|Promise<void>>} CollectionAsyncVoid\n */\n\n\n/**\n * @template T\n * @param {T=} type\n * @returns {HooksCollection<T>}\n */\nexport const createPipelineCollection = (type) =>\n    // @ts-ignore\n    createHooksCollection(\n        hooks =>\n            (value, ...rest) =>\n                hooks.reduce(\n                    (pipedValue, hook) =>\n                        pipedValue?.then\n                            ? pipedValue.then(r => hook(r, ...rest))\n                            : hook(pipedValue, ...rest),\n                    value,\n                ),\n    )\n\n/**\n * @template T\n * @param {T=} type\n * @returns {CollectionSyncVoid<T>|CollectionAsyncVoid<T>}\n */\nexport const createSequenceHooksCollection = (type) =>\n    createHooksCollection(\n        hooks =>\n            (value, ...rest) => hooks.reduce(\n                (last, hook) =>\n                    last?.then ? last.then(_ => hook(value, ...rest)) : hook(value, ...rest),\n                value,\n            )\n    )\n\n/**\n * @template T\n * @param {T=} type\n * @returns {CollectionSyncVoid<T>|CollectionAsyncVoid<T>}\n */\nexport const createParallelHooksCollection = (type) =>\n    createHooksCollection(\n        hooks =>\n            (value, ...rest) =>\n                Promise.all(hooks.map(hook => hook(value, ...rest))).then(r => value),\n    )\n\n/**\n * @template T\n * @param {T=} type\n * @returns {CollectionSync<T>|CollectionAsync<T>}\n */\nexport const createGuardsCollection = (type) =>\n    // @ts-ignore\n    createHooksCollection(\n        hooks =>\n            (value, ...rest) =>\n                hooks.reduce(\n                    (pipedValue, hook) =>\n                        pipedValue?.then\n                            ? pipedValue.then(r => r && hook(value, ...rest))\n                            : pipedValue && hook(value, ...rest),\n                    value || true,\n                ),\n    )\n"],
  "mappings": ";;;AAsCA,IAAM,wBAAwB,CAAC,WAAW;AAEtC,QAAM,QAAQ,CAAC;AAKf,QAAM,kBAAkB,UAAQ;AAC5B,UAAM,KAAK,IAAI;AACf,WAAO,MAAM,MAAM,OAAO,MAAM,QAAQ,IAAI,GAAG,CAAC;AAAA,EACpD;AAEA,kBAAgB,QAAQ;AACxB,kBAAgB,MAAM,OAAO,KAAK;AAElC,SAAO;AACX;AA2BO,IAAM,2BAA2B,CAAC,SAErC,sBACI,WACI,CAAC,UAAU,SACP,MAAM,OACF,CAAC,YAAY,SACT,0CAAY,QACN,WAAW,KAAK,OAAK,KAAK,GAAG,GAAG,IAAI,CAAC,IACrC,KAAK,YAAY,GAAG,IAAI,GAClC,KACJ,CACZ;AAOG,IAAM,gCAAgC,CAAC,SAC1C,sBACI,WACI,CAAC,UAAU,SAAS,MAAM,OACtB,CAAC,MAAM,SACH,8BAAM,QAAO,KAAK,KAAK,OAAK,KAAK,OAAO,GAAG,IAAI,CAAC,IAAI,KAAK,OAAO,GAAG,IAAI,GAC3E,KACJ,CACR;AAOG,IAAM,gCAAgC,CAAC,SAC1C,sBACI,WACI,CAAC,UAAU,SACP,QAAQ,IAAI,MAAM,IAAI,UAAQ,KAAK,OAAO,GAAG,IAAI,CAAC,CAAC,EAAE,KAAK,OAAK,KAAK,CAChF;AAOG,IAAM,yBAAyB,CAAC,SAEnC,sBACI,WACI,CAAC,UAAU,SACP,MAAM,OACF,CAAC,YAAY,SACT,0CAAY,QACN,WAAW,KAAK,OAAK,KAAK,KAAK,OAAO,GAAG,IAAI,CAAC,IAC9C,cAAc,KAAK,OAAO,GAAG,IAAI,GAC3C,SAAS,IACb,CACZ;",
  "names": []
}
