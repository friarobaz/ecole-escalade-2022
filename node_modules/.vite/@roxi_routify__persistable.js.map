{
  "version": 3,
  "sources": ["../persistable/lib/utils.js", "../persistable/lib/index.js", "dep:@roxi_routify__persistable"],
  "sourcesContent": ["const stringHashCode = (str) =>\r\n  str\r\n    .split('')\r\n    .reduce((a, b) => {\r\n      a = (a << 5) - a + b.charCodeAt(0)\r\n      return a & a\r\n    }, 0)\r\n    .toString(36)\r\n\r\nconst fnToName = (fn) => {\r\n  const fnStr = fn.toString()\r\n  const length = fnStr.length\r\n  const snippet = fnStr\r\n    .replace(/[^\\w]/gm, '_')\r\n    .replace(/\\_+/gm, '_')\r\n    .replace(/^\\_/, '')\r\n    .slice(0, 20)\r\n  return snippet + '-' + length + '-' + stringHashCode(fnStr)\r\n}\r\n\r\nmodule.exports = { fnToName }\r\n", "/// <reference path=\"../typedef.js\" />\r\n\r\nconst { existsSync, writeFileSync, mkdirSync, readFileSync } = require('fs')\r\nconst { resolve } = require('path')\r\nconst { fnToName } = require('./utils')\r\n\r\n/** @type {Options} */\r\nconst defaults = {\r\n  outputDir: 'persistable',\r\n  minify: false,\r\n}\r\n\r\n/** @type {Persistable} */\r\nconst persistable = (options = {}) => {\r\n  options = Object.assign(defaults, options)\r\n\r\n  /** @type {Persist} */\r\n  const persist = async (callback, refresh, name) => {\r\n    name = name || fnToName(callback)\r\n    const filepath = resolve(persist.outputDir, name + '.json')\r\n\r\n    if (!existsSync(filepath) || refresh) {\r\n      mkdirSync(persist.outputDir, { recursive: true })\r\n      const value = await callback()\r\n      const stamp = {value, updated: new Date}\r\n      writeFileSync(\r\n        filepath,\r\n        JSON.stringify(stamp, null, persist.minify ? 0 : 2),\r\n      )\r\n    }\r\n\r\n    return JSON.parse(readFileSync(filepath, 'utf-8')).value\r\n  }\r\n\r\n  Object.assign(persist, options)\r\n\r\n  return persist\r\n}\r\n\r\nmodule.exports = persistable\r\n", "export default require(\"./node_modules/persistable/lib/index.js\");"],
  "mappings": ";;;;;;;;;;;;AAAA;AAAA;AAAA,QAAM,iBAAiB,CAAC,QACtB,IACG,MAAM,EAAE,EACR,OAAO,CAAC,GAAG,MAAM;AAChB,UAAK,MAAK,KAAK,IAAI,EAAE,WAAW,CAAC;AACjC,aAAO,IAAI;AAAA,IACb,GAAG,CAAC,EACH,SAAS,EAAE;AAEhB,QAAM,WAAW,CAAC,OAAO;AACvB,YAAM,QAAQ,GAAG,SAAS;AAC1B,YAAM,SAAS,MAAM;AACrB,YAAM,UAAU,MACb,QAAQ,WAAW,GAAG,EACtB,QAAQ,SAAS,GAAG,EACpB,QAAQ,OAAO,EAAE,EACjB,MAAM,GAAG,EAAE;AACd,aAAO,UAAU,MAAM,SAAS,MAAM,eAAe,KAAK;AAAA,IAC5D;AAEA,WAAO,UAAU,EAAE,SAAS;AAAA;AAAA;;;ACpB5B;AAAA;AAEA,QAAM,EAAE,YAAY,eAAe,WAAW,iBAAiB;AAC/D,QAAM,EAAE,YAAY;AACpB,QAAM,EAAE,aAAa;AAGrB,QAAM,WAAW;AAAA,MACf,WAAW;AAAA,MACX,QAAQ;AAAA,IACV;AAGA,QAAM,cAAc,CAAC,UAAU,CAAC,MAAM;AACpC,gBAAU,OAAO,OAAO,UAAU,OAAO;AAGzC,YAAM,UAAU,OAAO,UAAU,SAAS,SAAS;AACjD,eAAO,QAAQ,SAAS,QAAQ;AAChC,cAAM,WAAW,QAAQ,QAAQ,WAAW,OAAO,OAAO;AAE1D,YAAI,CAAC,WAAW,QAAQ,KAAK,SAAS;AACpC,oBAAU,QAAQ,WAAW,EAAE,WAAW,KAAK,CAAC;AAChD,gBAAM,QAAQ,MAAM,SAAS;AAC7B,gBAAM,QAAQ,EAAC,OAAO,SAAS,IAAI,OAAI;AACvC,wBACE,UACA,KAAK,UAAU,OAAO,MAAM,QAAQ,SAAS,IAAI,CAAC,CACpD;AAAA,QACF;AAEA,eAAO,KAAK,MAAM,aAAa,UAAU,OAAO,CAAC,EAAE;AAAA,MACrD;AAEA,aAAO,OAAO,SAAS,OAAO;AAE9B,aAAO;AAAA,IACT;AAEA,WAAO,UAAU;AAAA;AAAA;;;ACvCjB,IAAO,mCAAQ;",
  "names": []
}
