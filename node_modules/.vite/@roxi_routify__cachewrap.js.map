{
  "version": 3,
  "sources": ["../cachewrap/index.js", "dep:@roxi_routify__cachewrap"],
  "sourcesContent": ["/**\r\n * @callback IdGenerator\r\n * @param {any[]} params\r\n * @returns {any}\r\n */\r\n\r\n/** @type {IdGenerator} */\r\nconst _idGenerator = params => params.map(param => param.toString()).join('-')\r\n\r\n/**\r\n * @param {IdGenerator} defaultIdGenerator \r\n */\r\nconst createCacheWrap = (defaultIdGenerator = _idGenerator) => {\r\n    const cache = new Map()\r\n\r\n    /**\r\n     * @template {(...params: any[]) => any} T\r\n     * @param {T} fn\r\n     * @param {IdGenerator} idGenerator\r\n     * @returns {T & {refresh: T}}\r\n     */\r\n    const cacheWrap = (fn, idGenerator = defaultIdGenerator) => {\r\n        const wrapped = (...params) => {\r\n            const id = idGenerator(params)\r\n            if (!cache.has(id)) {\r\n                const result = fn(...params)\r\n                if (result && result.then) {\r\n                    return new Promise(resolve => {\r\n                        result.then(res => {\r\n                            cache.set(id, res)\r\n                            resolve(res)\r\n                        })\r\n                    })\r\n                } else cache.set(id, result)\r\n            }\r\n            return cache.get(id)\r\n        }\r\n\r\n        wrapped.refresh = (...params) => {\r\n            const id = idGenerator(params)\r\n            cache.delete(id)\r\n            return wrapped(...params)\r\n        }\r\n\r\n        /** @ts-ignore */\r\n        return wrapped\r\n    }\r\n\r\n    return cacheWrap\r\n}\r\n\r\nmodule.exports = createCacheWrap", "export default require(\"./node_modules/cachewrap/index.js\");"],
  "mappings": ";;;;;AAAA;AAAA;AAOA,QAAM,eAAe,YAAU,OAAO,IAAI,WAAS,MAAM,SAAS,CAAC,EAAE,KAAK,GAAG;AAK7E,QAAM,kBAAkB,CAAC,qBAAqB,iBAAiB;AAC3D,YAAM,QAAQ,oBAAI,IAAI;AAQtB,YAAM,YAAY,CAAC,IAAI,cAAc,uBAAuB;AACxD,cAAM,UAAU,IAAI,WAAW;AAC3B,gBAAM,KAAK,YAAY,MAAM;AAC7B,cAAI,CAAC,MAAM,IAAI,EAAE,GAAG;AAChB,kBAAM,SAAS,GAAG,GAAG,MAAM;AAC3B,gBAAI,UAAU,OAAO,MAAM;AACvB,qBAAO,IAAI,QAAQ,aAAW;AAC1B,uBAAO,KAAK,SAAO;AACf,wBAAM,IAAI,IAAI,GAAG;AACjB,0BAAQ,GAAG;AAAA,gBACf,CAAC;AAAA,cACL,CAAC;AAAA,YACL;AAAO,oBAAM,IAAI,IAAI,MAAM;AAAA,UAC/B;AACA,iBAAO,MAAM,IAAI,EAAE;AAAA,QACvB;AAEA,gBAAQ,UAAU,IAAI,WAAW;AAC7B,gBAAM,KAAK,YAAY,MAAM;AAC7B,gBAAM,OAAO,EAAE;AACf,iBAAO,QAAQ,GAAG,MAAM;AAAA,QAC5B;AAGA,eAAO;AAAA,MACX;AAEA,aAAO;AAAA,IACX;AAEA,WAAO,UAAU;AAAA;AAAA;;;ACnDjB,IAAO,iCAAQ;",
  "names": []
}
