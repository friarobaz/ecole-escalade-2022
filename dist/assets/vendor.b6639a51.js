var nt=Object.defineProperty,rt=Object.defineProperties;var st=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var Se=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var ue=(n,e,t)=>e in n?nt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,S=(n,e)=>{for(var t in e||(e={}))Se.call(e,t)&&ue(n,t,e[t]);if(Q)for(var t of Q(e))Ce.call(e,t)&&ue(n,t,e[t]);return n},z=(n,e)=>rt(n,st(e));var Y=(n,e)=>{var t={};for(var r in n)Se.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&Q)for(var r of Q(n))e.indexOf(r)<0&&Ce.call(n,r)&&(t[r]=n[r]);return t};var h=(n,e,t)=>(ue(n,typeof e!="symbol"?e+"":e,t),t),Fe=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var U=(n,e,t)=>(Fe(n,e,"read from private field"),t?t.call(n):e.get(n)),ce=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},Ie=(n,e,t,r)=>(Fe(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t);function E(){}function ge(n,e){for(const t in e)n[t]=e[t];return n}function Le(n){return n()}function xe(){return Object.create(null)}function v(n){n.forEach(Le)}function pe(n){return typeof n=="function"}function K(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function ot(n){return Object.keys(n).length===0}function _e(n,...e){if(n==null)return E;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function x(n){let e;return _e(n,t=>e=t)(),e}function be(n,e,t,r){if(n){const s=We(n,e,t,r);return n[0](s)}}function We(n,e,t,r){return n[1]&&r?ge(t.ctx.slice(),n[1](r(e))):t.ctx}function ye(n,e,t,r){if(n[2]&&r){const s=n[2](r(t));if(e.dirty===void 0)return s;if(typeof s=="object"){const o=[],i=Math.max(e.dirty.length,s.length);for(let a=0;a<i;a+=1)o[a]=e.dirty[a]|s[a];return o}return e.dirty|s}return e.dirty}function we(n,e,t,r,s,o){if(s){const i=We(e,t,r,o);n.p(i,s)}}function Re(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let r=0;r<t;r++)e[r]=-1;return e}return-1}function ze(n){return n&&pe(n.destroy)?n.destroy:E}function P(n,e,t){n.insertBefore(e,t||null)}function k(n){n.parentNode.removeChild(n)}function Ge(n){return document.createElement(n)}function Me(n){return document.createTextNode(n)}function it(){return Me(" ")}function B(){return Me("")}function lt(n){return Array.from(n.childNodes)}function at(n,e,t,r){t===null?n.style.removeProperty(e):n.style.setProperty(e,t,r?"important":"")}let J;function M(n){J=n}function Ne(){if(!J)throw new Error("Function called outside component initialization");return J}function ut(n){Ne().$$.on_destroy.push(n)}function Je(n,e){Ne().$$.context.set(n,e)}function Ke(n){return Ne().$$.context.get(n)}const G=[],Oe=[],$=[],je=[],ct=Promise.resolve();let he=!1;function ft(){he||(he=!0,ct.then(Xe))}function de(n){$.push(n)}const fe=new Set;let Z=0;function Xe(){const n=J;do{for(;Z<G.length;){const e=G[Z];Z++,M(e),ht(e.$$)}for(M(null),G.length=0,Z=0;Oe.length;)Oe.pop()();for(let e=0;e<$.length;e+=1){const t=$[e];fe.has(t)||(fe.add(t),t())}$.length=0}while(G.length);for(;je.length;)je.pop()();he=!1,fe.clear(),M(n)}function ht(n){if(n.fragment!==null){n.update(),v(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(de)}}const ee=new Set;let O;function L(){O={r:0,c:[],p:O}}function W(){O.r||v(O.c),O=O.p}function b(n,e){n&&n.i&&(ee.delete(n),n.i(e))}function y(n,e,t,r){if(n&&n.o){if(ee.has(n))return;ee.add(n),O.c.push(()=>{ee.delete(n),r&&(t&&n.d(1),r())}),n.o(e)}}function Qe(n,e){const t={},r={},s={$$scope:1};let o=n.length;for(;o--;){const i=n[o],a=e[o];if(a){for(const l in i)l in a||(r[l]=1);for(const l in a)s[l]||(t[l]=a[l],s[l]=1);n[o]=a}else for(const l in i)s[l]=1}for(const i in r)i in t||(t[i]=void 0);return t}function me(n){return typeof n=="object"&&n!==null?n:{}}function A(n){n&&n.c()}function F(n,e,t,r){const{fragment:s,on_mount:o,on_destroy:i,after_update:a}=n.$$;s&&s.m(e,t),r||de(()=>{const l=o.map(Le).filter(pe);i?i.push(...l):v(l),n.$$.on_mount=[]}),a.forEach(de)}function I(n,e){const t=n.$$;t.fragment!==null&&(v(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function dt(n,e){n.$$.dirty[0]===-1&&(G.push(n),ft(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function ne(n,e,t,r,s,o,i,a=[-1]){const l=J;M(n);const u=n.$$={fragment:null,ctx:null,props:o,update:E,not_equal:s,bound:xe(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:xe(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};i&&i(u.root);let c=!1;if(u.ctx=t?t(n,e.props||{},(d,g,...p)=>{const m=p.length?p[0]:g;return u.ctx&&s(u.ctx[d],u.ctx[d]=m)&&(!u.skip_bound&&u.bound[d]&&u.bound[d](m),c&&dt(n,d)),g}):[],u.update(),c=!0,v(u.before_update),u.fragment=r?r(u.ctx):!1,e.target){if(e.hydrate){const d=lt(e.target);u.fragment&&u.fragment.l(d),d.forEach(k)}else u.fragment&&u.fragment.c();e.intro&&b(n.$$.fragment),F(n,e.target,e.anchor,e.customElement),Xe()}M(l)}class re{$destroy(){I(this,1),this.$destroy=E}$on(e,t){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(t),()=>{const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}$set(e){this.$$set&&!ot(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const D=[];function mt(n,e){return{subscribe:se(n,e).subscribe}}function se(n,e=E){let t;const r=new Set;function s(a){if(K(n,a)&&(n=a,t)){const l=!D.length;for(const u of r)u[1](),D.push(u,n);if(l){for(let u=0;u<D.length;u+=2)D[u][0](D[u+1]);D.length=0}}}function o(a){s(a(n))}function i(a,l=E){const u=[a,l];return r.add(u),r.size===1&&(t=e(s)||E),a(n),()=>{r.delete(u),r.size===0&&(t(),t=null)}}return{set:s,update:o,subscribe:i}}function gt(n,e,t){const r=!Array.isArray(n),s=r?[n]:n,o=e.length<2;return mt(t,i=>{let a=!1;const l=[];let u=0,c=E;const d=()=>{if(u)return;c();const p=e(r?l[0]:l,i);o?i(p):c=pe(p)?p:E},g=s.map((p,m)=>_e(p,_=>{l[m]=_,u&=~(1<<m),a&&d()},()=>{u|=1<<m}));return a=!0,d(),function(){v(g),c()}})}const pt=n=>n.name.match(/\[\.\.\.(.+)\]/)?1:-1,_t=n=>{var e;for(const t of[...n].reverse())for(const r of((e=t.node.parent)==null?void 0:e.children)||[])if(r.name.match(/\[\.\.\.(.+)\]/))return r},bt=n=>n.replace(/[?#].+/,"").replace(/\/$/,"").split("/").slice(1),yt=(n,e)=>n.findIndex(t=>t.node===e),wt=n=>n instanceof Array?n.map(decodeURI):decodeURI(n),Rt=n=>Object.entries(n).reduce((e,[t,r])=>z(S({},e),{[t]:wt(r)}),{});class V{constructor(e,t,r){h(this,"_params",{});this.route=e,this.node=t,this.load=void 0,this.urlFragment=r,Object.defineProperty(this,"route",{enumerable:!1})}get params(){return Rt(this._params)}setParams(e){this._params=e}getParamsFromFragment(){const{getFieldsFromName:e,getValuesFromPath:t,mapFieldsWithValues:r}=this.route.router.instance.utils;return r(e(this.node.name),t(this.node.regex,this.urlFragment))}}const Nt=["pushState","replaceState","popState"];class Et{constructor(e,t,r){h(this,"allFragments",[]);h(this,"loaded");h(this,"load",{status:200,error:null,maxage:null,props:{},redirect:null});if(this.router=e,this.url=t,this.mode=r,!e.rootNode){this.router.log.error("Can't navigate without a rootNode");const s=new Error("Can't navigate without a rootNode");throw Object.assign(s,{routify:{router:e}}),s}if(!Nt.includes(r))throw new Error("url.mode must be pushState, replaceState or popState");this.allFragments=this._createFragments()}get fragments(){const e=this.allFragments.filter(t=>t.node.module);return this.router.transformFragments.run(e)}get params(){const e=this.url.match(/\?.+/),t=e&&e[0]||"";return Object.assign({},...this.allFragments.map(r=>r.params),this.router.queryHandler.parse(t,this))}async loadRoute(){const{router:e}=this,t=[this.runBeforeUrlChangeHooks,this.loadComponents,this.runGuards,this.runPreloads];return this.loaded=new Promise(async(r,s)=>{for(const i of t){const a=await i.bind(this)(),l=this!==e.pendingRoute.get();if(e.pendingRoute.get()){if(l){e.pendingRoute.get().loaded.then(r).catch(s);return}else if(!a){e.pendingRoute.set(null);return}}else{r({route:e.activeRoute.get()});return}}const o=this.router.activeRoute.get();o&&e.history.push(o),e.activeRoute.set(this),e.afterUrlChange.run({route:this,history:[...e.history].reverse()}),e.pendingRoute.set(null),r({route:this})}),this.loaded}async loadComponents(){return await Promise.all(this.fragments.map(async e=>{const t=await e.node.module();e.node.module=()=>t})),!0}async runPreloads(){var t;const e={route:this,node:[...this.fragments].pop().node};for(const r of this.fragments)if((t=r.node.module())!=null&&t.load&&(r.load=await r.node.module().load(e),Object.assign(this.load,r.load),this.load.redirect))return this.router.url.replace(this.load.redirect);return this}async runGuards(){const e=this.fragments.map(t=>t.node.module()).filter(t=>t==null?void 0:t.guard);for(const t of e)if(console.warn('"guard" will be deprecated. Please use "load.redirect" instead.'),!await t.guard(this))return!1;return!0}async runBeforeUrlChangeHooks(){return await this.router.beforeUrlChange.run({route:this})}_createFragments(){const{url:e="",router:t}=this,{rootNode:r}=t;let s=[],o=r;const i=(c,d,g)=>{const p=new V(this,c,d),m=c.name.match(/\[\.\.\.(.+)\]/);return m?g.push(d):g=[],m?p.setParams({[m[1]]:g}):p.setParams(p.getParamsFromFragment()),p},a=bt(e),l=[new V(this,o,"")];for(let c=0;c<a.length;c++){const d=a[c],g=o.children.filter(m=>!m.name.startsWith("_")),p=g.find(m=>m.name===d)||g.sort(pt).find(m=>m.regex.test(d));if(p)l.push(i(p,d,s)),o=p;else if(s.length)s.push(d);else{const m=_t(l);if(m){const _=yt(l,m),w=l.splice(_);c=c-w.length,l.push(i(m,a[c],s)),o=m}else{const _=o._fallback;if(!_)throw new Error(`router: "${t.name||"[default]"}" could not find route: ${e}`);l.splice(_.level),l.push(new V(this,_,""));break}}}let u=l[l.length-1].node;for(;u;)u=u.children.find(c=>c.name==="index"),u&&l.push(new V(this,u,""));if(!l.filter(({node:c})=>c.module).length)throw new Error(`could not find route: ${e}`);return l}}const kt=n=>{const e=n.target.closest("a"),t=e&&e.href;if(n.ctrlKey||n.metaKey||n.altKey||n.shiftKey||n.button||n.key&&n.key!=="Enter"||n.defaultPrevented||!t||e.target||e.host!==location.host)return;const r=new URL(t),s=r.pathname+r.search+r.hash;return n.preventDefault(),s},Ut=n=>[...n].reduce((e,[t,r])=>(e[t]=r,e),{}),Pt=()=>(({pathname:n,search:e,hash:t})=>n+e+t)(window.location),St=n=>{try{return Ke(n)}catch{}},He=(n,e)=>{const t=se(n,e);return Object.assign(t,{get:()=>x(t)})},Ct=(...n)=>n.map(e=>JSON.stringify([e==null?void 0:e.allFragments,e==null?void 0:e.url])).reduce((e,t)=>e===t&&t);class Ye{constructor(e){this.router=e,this.log=this.router.log}install(){}uninstall(){}reflect(){}}const Ft=n=>{const e=(n==null?void 0:n.delimiter)||";";return{toRouter:(t,r)=>{const s=r.name?`${r.name}=(.+?)`:"(.+?)",o=new RegExp(`(^|${e})${s}(${e}|$)`),i=t.match(o);return i?i[2]:"/"},toBrowser:t=>t.map(r=>(r.name?`${r.name}=`:"")+r.url.external()).join(e)}};class It{constructor(){h(this,"instances",[]);h(this,"browserAdapter",Ft());h(this,"urlFromBrowser",e=>this.browserAdapter.toRouter(Pt(),e));typeof window!="undefined"&&(window.__routify=this)}get routers(){return[].concat(...this.instances.map(e=>e.routers))}register(e){return this.instances.push(e),this}}const te=new It,xt=/\[(.+?)\]/gm;class Ot{constructor(e=xt){h(this,"getFieldsFromName",e=>[...e.matchAll(this.RE)].map(t=>t[1]));h(this,"getRegexFromName",e=>new RegExp("^"+e.replace(this.RE,"(.+)")+"$"));h(this,"getValuesFromPath",(e,t)=>(t.match(e)||[]).slice(1));h(this,"mapFieldsWithValues",(e,t)=>this.haveEqualLength(e,t)&&e.reduce((r,s,o)=>(r[s]=t[o],r),{}));h(this,"haveEqualLength",(e,t)=>{if(e.length!==t.length)throw new Error(`fields and values should be of same length
fields: ${JSON.stringify(e)}
values: ${JSON.stringify(t)}`);return!0});this.RE=e}}class Ze{constructor(e,t,r){h(this,"instance");h(this,"parent");h(this,"meta",{});h(this,"id");this.instance=r,this.name=e,r.nodeIndex.push(this),this.module=t,Object.defineProperty(this,"Instance",{enumerable:!1}),Object.defineProperty(this,"instance",{enumerable:!1}),Object.defineProperty(this,"parent",{enumerable:!1})}appendChild(e){e.parent=this}createChild(e,t){const r=this.instance.createNode(e,t);return this.appendChild(r),r}get descendants(){return this.instance.nodeIndex.filter(e=>e.ancestors.find(t=>t===this))}remove(){const{nodeIndex:e}=this.instance,t=e.findIndex(r=>r===this);e.splice(t,1)}get ancestors(){let e=this;const t=[];for(;e=e.parent;)t.push(e);return t}get root(){let e=this;for(;e.parent;)e=e.parent;return e}get isRoot(){return this===this.root}get children(){return this.instance.nodeIndex.filter(e=>e.parent===this)}get level(){var e;return(((e=this.parent)==null?void 0:e.level)||0)+1}traverse(e){const t=e.startsWith("/")?this.root:this,r=e.split("/").filter(s=>s!==".").filter(Boolean);try{return r.reduce((o,i)=>i===".."?o.parent:o.children.find(a=>a.name===i),t)}catch(s){console.error("can't resolve path",e,"from",this.path,`
`,s)}}toJSON(){return z(S({},this),{children:[...this.children]})}get path(){return"/"+[this,...this.ancestors].reverse().map(e=>e.name).filter(Boolean).join("/")}}function jt(n){let e;const t=n[4].default,r=be(t,n,n[5],null);return{c(){r&&r.c()},m(s,o){r&&r.m(s,o),e=!0},p(s,o){r&&r.p&&(!e||o&32)&&we(r,t,s,s[5],e?ye(t,s[5],o,null):Re(s[5]),null)},i(s){e||(b(r,s),e=!0)},o(s){y(r,s),e=!1},d(s){r&&r.d(s)}}}function Ht(n){let e,t,r=n[2]&&Ae(n);return{c(){r&&r.c(),e=B()},m(s,o){r&&r.m(s,o),P(s,e,o),t=!0},p(s,o){s[2]?r?(r.p(s,o),o&4&&b(r,1)):(r=Ae(s),r.c(),b(r,1),r.m(e.parentNode,e)):r&&(L(),y(r,1,1,()=>{r=null}),W())},i(s){t||(b(r),t=!0)},o(s){y(r),t=!1},d(s){r&&r.d(s),s&&k(e)}}}function Ae(n){let e,t;const r=[n[1],{context:n[3]}];let s={$$slots:{default:[At]},$$scope:{ctx:n}};for(let o=0;o<r.length;o+=1)s=ge(s,r[o]);return e=new n[2]({props:s}),{c(){A(e.$$.fragment)},m(o,i){F(e,o,i),t=!0},p(o,i){const a=i&10?Qe(r,[i&2&&me(o[1]),i&8&&{context:o[3]}]):{};i&32&&(a.$$scope={dirty:i,ctx:o}),e.$set(a)},i(o){t||(b(e.$$.fragment,o),t=!0)},o(o){y(e.$$.fragment,o),t=!1},d(o){I(e,o)}}}function At(n){let e;const t=n[4].default,r=be(t,n,n[5],null);return{c(){r&&r.c()},m(s,o){r&&r.m(s,o),e=!0},p(s,o){r&&r.p&&(!e||o&32)&&we(r,t,s,s[5],e?ye(t,s[5],o,null):Re(s[5]),null)},i(s){e||(b(r,s),e=!0)},o(s){y(r,s),e=!1},d(s){r&&r.d(s)}}}function qt(n){let e,t,r,s;const o=[Ht,jt],i=[];function a(l,u){return l[0].module?0:1}return e=a(n),t=i[e]=o[e](n),{c(){t.c(),r=B()},m(l,u){i[e].m(l,u),P(l,r,u),s=!0},p(l,[u]){let c=e;e=a(l),e===c?i[e].p(l,u):(L(),y(i[c],1,1,()=>{i[c]=null}),W(),t=i[e],t?t.p(l,u):(t=i[e]=o[e](l),t.c()),b(t,1),t.m(r.parentNode,r))},i(l){s||(b(t),s=!0)},o(l){y(t),s=!1},d(l){i[e].d(l),l&&k(r)}}}const qe="routify-fragment-context";function Tt(n,e,t){let{$$slots:r={},$$scope:s}=e,{node:o}=e,{passthrough:i}=e;const a=z(S({},Ke(qe)),{node:o});Je(qe,a);let l;return o.module&&o.getRawComponent().then(u=>t(2,l=u)),n.$$set=u=>{"node"in u&&t(0,o=u.node),"passthrough"in u&&t(1,i=u.passthrough),"$$scope"in u&&t(5,s=u.$$scope)},[o,i,l,a,r,s]}class Dt extends re{constructor(e){super();ne(this,e,Tt,qt,K,{node:0,passthrough:1})}}var H;class vt extends Ze{constructor(){super(...arguments);ce(this,H,{});h(this,"importTree",e=>{const t=[[this,e]];for(;t.length;){const[s,o]=t.pop(),r=o,{children:i}=r,a=Y(r,["children"]);Object.assign(s,a);for(const l of i){const u=s.createChild(o.name||o.rootName||"");t.push([u,l])}}return this})}get regex(){const{name:e}=this;return U(this,H)[e]||(U(this,H)[e]=this.instance.utils.getRegexFromName(this.name)),U(this,H)[e]}set regex(e){U(this,H)[this.name]=new RegExp(e)}get children(){return this.instance.nodeIndex.filter(t=>t.parent===this).sort((t,r)=>(t.meta.order||0)-(r.meta.order||0))}get pages(){return this.children.filter(e=>e.name!=="index").filter(e=>!e.meta.fallback).filter(e=>!e.name.startsWith("_")).filter(e=>!e.name.includes("[")).filter(e=>{var t;return((t=e.meta)==null?void 0:t.order)!==!1})}getRawComponent(){return this.module&&new Promise(e=>{const t=this.module(),r=t.then?t.then(s=>s.default):t.default;e(r)})}get component(){const e=this;return function(t){return t.props=z(S({},t.props),{passthrough:t.props,node:e}),new Dt(S({},t))}}appendChild(e){e.instance&&(e.parent=this)}get _fallback(){var e;return this.children.find(t=>t.meta.fallback)||((e=this.parent)==null?void 0:e._fallback)}}H=new WeakMap;class Bt{constructor(e){h(this,"Node",Ze);h(this,"mode","runtime");h(this,"nodeIndex",[]);h(this,"rootNodes",{})}createNode(e,t){return new this.Node(e,t,this)}}class Lt extends Bt{constructor(e){super();h(this,"Node",vt);h(this,"mode","runtime");h(this,"routers",[]);h(this,"rootNodes",{});this.options=e,e.routes&&(this.rootNodes[e.routes.rootName||"unnamed"]=this.createNode(e.routes.rootName).importTree(e.routes)),this.utils=new Ot,this.global=te.register(this),Object.defineProperty(this,"routers",{enumerable:!1}),this.log=this.global.log}}const Ee=n=>{const e=[],t=r=>(e.push(r),()=>e.splice(e.indexOf(r),1));return t.hooks=e,t.run=n(e),t},Wt=n=>Ee(e=>(t,...r)=>e.reduce((s,o)=>s!=null&&s.then?s.then(i=>o(i,...r)):o(s,...r),t)),j=n=>Ee(e=>(t,...r)=>e.reduce((s,o)=>s!=null&&s.then?s.then(i=>o(t,...r)):o(t,...r),t)),zt=n=>Ee(e=>(t,...r)=>e.reduce((s,o)=>s!=null&&s.then?s.then(i=>i&&o(t,...r)):s&&o(t,...r),t||!0));class Gt extends Ye{constructor(e){super(e);h(this,"reflect",()=>{const{mode:e}=x(this.router.activeRoute);if(e==="popState")return!1;const{routers:t,browserAdapter:r}=this.router.instance.global,s=t.filter(i=>i.urlReflector instanceof this.constructor),o=r.toBrowser(s);history[`${e}Native`]({},"",o)});const{instance:t,urlRewrites:r}=e,{urlFromBrowser:s,browserAdapter:o}=t.global;history.onPushstate||Mt();const i=a=>function(l,u,c){var g,p;const d=(p=(g=l==null?void 0:l.routify)==null?void 0:g.router)!=null?p:!1;if(d===!1)c=o.toRouter(c,e);else if(d!==e.name)return!1;for(const m of r)c=m.toInternal(c,{router:e});e.url[a](c)};this.absorb=()=>e.url.replace(s(e)),this._pushstateHandler=i("push"),this._replacestateHandler=i("replace"),this._popstateHandler=()=>e.url.pop(s(e))}install(){this.hooks=[history.onPushstate(this._pushstateHandler),history.onReplacestate(this._replacestateHandler),history.onPopstate(this._popstateHandler)],x(this.router.activeRoute)?this.reflect():this.absorb()}uninstall(){this.hooks.forEach(e=>e()),setTimeout(()=>this.reflect())}}function Mt(){const n={onPushstate:j(),onReplacestate:j(),onPopstate:j()};Object.assign(history,n);const{pushState:e,replaceState:t}=history;return history.pushStateNative=e,history.replaceStateNative=t,history.pushState=n.onPushstate.run,history.replaceState=n.onReplacestate.run,window.addEventListener("popstate",n.onPopstate.run),!0}class Jt extends Ye{}const Kt=()=>new Promise(requestAnimationFrame),Xt=(n=100)=>new Promise(e=>{let t;const r=async s=>{clearTimeout(t),await Kt(),t=setTimeout(()=>{e(),removeEventListener("scroll",r)},n)};addEventListener("scroll",r)}),Qt=n=>te.routers.find(e=>e.parentElem===n),Yt=()=>{const n=se(!1);return{isScrolling:n,run:o=>{var i=o,{route:t,history:r}=i,s=Y(i,["route","history"]);var p;const[a,l]=t.url.split("#"),[u,c]=((p=r[0])==null?void 0:p.url.split("#"))||[],d=async m=>{const _=a===u,w=document.getElementById(l);if(w&&w.scrollIntoView({behavior:_?"smooth":"auto"}),_&&w&&(n.set(!0),await Xt(),n.set(!1)),!_&&m){const N=new MutationObserver(()=>d());N.observe(document.body,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),setTimeout(N.disconnect.bind(N),500)}},g=m=>{if(m){m.scrollTop=0;const _=m.parentElement;_&&_.scrollTo&&(_==null?void 0:_.dataset["routify-scroll"])!=="lock"&&!Qt(_)&&g(m.parentElement)}};l?d(!0):g(t.router.parentElem)}}},Zt={beforeRouterInit:({router:n})=>{const{isScrolling:e,run:t}=Yt();n.afterUrlChange(t),n.scrollHandler={isScrolling:e}}};var Vt=()=>({beforeUrlChange:({route:n})=>{const e=n.allFragments;return e.forEach(t=>{const{reset:r}=t.node.meta;if(r){const s=e.indexOf(t),o=r===!0?s:Number(r),i=s-o;e.splice(i,s)}}),!0}});const $t=n=>Object.fromEntries(Object.entries(n).filter(([e,t])=>t!=null)),Ve=(n,e)=>{e=e||{name:"",beforeRouterInit:[],afterRouterInit:[],urlRewrite:[],beforeUrlChange:[],afterUrlChange:[],transformFragments:[],onDestroy:[]};const o=n,{plugins:t}=o,r=Y(o,["plugins"]);return[...t||[],r].forEach(i=>{"plugin"in i&&Ve(i,e),Object.entries(i).forEach(([a,l])=>{Array.isArray(e[a])?e[a].push(...[l].flat().filter(Boolean)):e[a]=l||e[a]})}),e},en=[Zt,Vt()];var C;const ke=class{constructor(e){h(this,"pendingRoute",He(null));h(this,"activeRoute",He(null));ce(this,C,null);h(this,"urlRewrites",[]);h(this,"beforeRouterInit",j());h(this,"afterRouterInit",j());h(this,"beforeUrlChange",zt());h(this,"afterUrlChange",j());h(this,"transformFragments",Wt());h(this,"onDestroy",j());h(this,"parentElem",null);h(this,"queryHandler",{parse:(e,t)=>Ut(new URLSearchParams(e)),stringify:(e,t)=>{const r=new URLSearchParams(e).toString();return r?`?${r}`:""}});h(this,"url",{internal:()=>this.url.getPending()||this.url.getActive(),external:()=>this.getExternalUrl(),getActive:()=>{var e;return(e=x(this.activeRoute))==null?void 0:e.url},getPending:()=>{var e;return(e=x(this.pendingRoute))==null?void 0:e.url},toString:()=>this.url.internal(),set:this._setUrl,push:e=>this._setUrl(e,"pushState"),replace:e=>this._setUrl(e,"replaceState"),pop:e=>this._setUrl(e,"popState")});h(this,"ready",(()=>new Promise(e=>{let t;t=this.activeRoute.subscribe(r=>{r&&e(),t&&t()})}))());h(this,"history",[]);h(this,"setParentElem",e=>this.parentElem=e.parentElement);h(this,"getExternalUrl",e=>this.urlRewrites.reduce((r,s)=>s.toExternal(r,{router:this}),e||this.url.internal()));h(this,"getInternalUrl",e=>this.urlRewrites.reduce((t,r)=>r.toInternal(t,{router:this}),e));const{subscribe:t,set:r}=se(this);this.subscribe=t,this.triggerStore=()=>r(this),e.plugins=[...e.plugins||[],...en].filter(Boolean),this.init(e),this.params=gt(this.activeRoute,s=>s.params),this.afterUrlChange(()=>setTimeout(()=>U(this,C).reflect())),this.activeRoute.get=()=>x(this.activeRoute),this.pendingRoute.get=()=>x(this.pendingRoute)}init(e){const t=!this.options;e=$t(e),this.options=Ve(S(S({},this.options),e));let{instance:r,rootNode:s,name:o,routes:i,urlRewrite:a,urlReflector:l,url:u,passthrough:c,beforeUrlChange:d,afterUrlChange:g,transformFragments:p,onDestroy:m,beforeRouterInit:_,afterRouterInit:w,queryHandler:N}=this.options;N&&(this.queryHandler=N),d.forEach(this.beforeUrlChange),p.forEach(this.transformFragments),g.forEach(this.afterUrlChange),m.forEach(this.onDestroy),_.forEach(this.beforeRouterInit),w.forEach(this.afterRouterInit),this.beforeRouterInit.run({router:this,firstInit:t});const R=St("routify-fragment-context");this.instance=r||this.instance||(R==null?void 0:R.route.router.instance)||te.instances[0]||new Lt({}),this.name=o,this.urlRewrites=a,c&&!(c instanceof ke)&&(c=(R==null?void 0:R.route.router)||c),this.passthrough=c||this.passthrough,te.instances.forEach(q=>{const T=q.routers.indexOf(this);T!==-1&&q.routers.splice(T,1)}),this.instance.routers.push(this),i&&this.importRoutes(i),this.parentCmpCtx=R,this.rootNode=s||this.rootNode||this.instance.rootNodes.default,this.url.getActive()&&this._setUrl(this.url.getActive(),"pushState",!0),(!this.urlReflector||l&&!(this.urlReflector instanceof l))&&(l=l||(typeof window!="undefined"?Gt:Jt),this.setUrlReflector(l)),u&&this.url.replace(u),this.triggerStore(),this.afterRouterInit.run({router:this,firstInit:t})}importRoutes(e){this.rootNode=this.instance.createNode().importTree(e),this.instance.rootNodes[e.rootName||"unnamed"]=this.rootNode}async _setUrl(e,t,r){r||(e=this.getInternalUrl(e)),e=e||"/",e=e.replace(/(.+)\/+([#?]|$)/,"$1$2");const{activeRoute:s,pendingRoute:o}=this;s.get(),e.startsWith("/")||(e=e.replace(new URL(e).origin,""));const i=new Et(this,e,t),a=o.get()||s.get();return Ct(a,i)||(o.set(i),await i.loadRoute()),!0}destroy(){this.instance.routers=this.instance.routers.filter(e=>e!==this),this.onDestroy.run({router:this})}get urlReflector(){return U(this,C)}setUrlReflector(e){var t;(t=U(this,C))==null||t.uninstall(),Ie(this,C,new e(this)),U(this,C).install(),this.triggerStore()}};let $e=ke;C=new WeakMap;function tn(n){let e;const t=n[2].default,r=be(t,n,n[1],null);return{c(){r&&r.c()},m(s,o){r&&r.m(s,o),e=!0},p(s,[o]){r&&r.p&&(!e||o&2)&&we(r,t,s,s[1],e?ye(t,s[1],o,null):Re(s[1]),null)},i(s){e||(b(r,s),e=!0)},o(s){y(r,s),e=!1},d(s){r&&r.d(s)}}}function nn(n,e,t){let{$$slots:r={},$$scope:s}=e,{context:o=null}=e;return n.$$set=i=>{"context"in i&&t(0,o=i.context),"$$scope"in i&&t(1,s=i.$$scope)},[o,s,r]}class Te extends re{constructor(e){super();ne(this,e,nn,tn,K,{context:0})}}function De(n){let e,t;return e=new et({props:{fragments:n[5],props:n[1],decorator:n[0]}}),{c(){A(e.$$.fragment)},m(r,s){F(e,r,s),t=!0},p(r,s){const o={};s&32&&(o.fragments=r[5]),s&2&&(o.props=r[1]),s&1&&(o.decorator=r[0]),e.$set(o)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){y(e.$$.fragment,r),t=!1},d(r){I(e,r)}}}function rn(n){let e,t,r=n[5].length&&De(n);return{c(){r&&r.c(),e=B()},m(s,o){r&&r.m(s,o),P(s,e,o),t=!0},p(s,o){s[5].length?r?(r.p(s,o),o&32&&b(r,1)):(r=De(s),r.c(),b(r,1),r.m(e.parentNode,e)):r&&(L(),y(r,1,1,()=>{r=null}),W())},i(s){t||(b(r),t=!0)},o(s){y(r),t=!1},d(s){r&&r.d(s),s&&k(e)}}}function sn(n){var a;let e,t,r;const s=[{context:n[2]},n[1],(a=n[4])==null?void 0:a.props];var o=n[3].node.module().default;function i(l){let u={$$slots:{default:[rn,({props:c,decorator:d})=>({1:c,0:d}),({props:c,decorator:d})=>(c?2:0)|(d?1:0)]},$$scope:{ctx:l}};for(let c=0;c<s.length;c+=1)u=ge(u,s[c]);return{props:u}}return o&&(e=new o(i(n))),{c(){e&&A(e.$$.fragment),t=B()},m(l,u){e&&F(e,l,u),P(l,t,u),r=!0},p(l,u){var d;const c=u&22?Qe(s,[u&4&&{context:l[2]},u&2&&me(l[1]),u&16&&me((d=l[4])==null?void 0:d.props)]):{};if(u&547&&(c.$$scope={dirty:u,ctx:l}),o!==(o=l[3].node.module().default)){if(e){L();const g=e;y(g.$$.fragment,1,0,()=>{I(g,1)}),W()}o?(e=new o(i(l)),A(e.$$.fragment),b(e.$$.fragment,1),F(e,t.parentNode,t)):e=null}else o&&e.$set(c)},i(l){r||(e&&b(e.$$.fragment,l),r=!0)},o(l){e&&y(e.$$.fragment,l),r=!1},d(l){l&&k(t),e&&I(e,l)}}}function on(n){let e,t,r;var s=n[0]||Te;function o(i){return{props:{context:i[2],$$slots:{default:[sn]},$$scope:{ctx:i}}}}return s&&(e=new s(o(n))),{c(){e&&A(e.$$.fragment),t=B()},m(i,a){e&&F(e,i,a),P(i,t,a),r=!0},p(i,[a]){const l={};if(a&4&&(l.context=i[2]),a&575&&(l.$$scope={dirty:a,ctx:i}),s!==(s=i[0]||Te)){if(e){L();const u=e;y(u.$$.fragment,1,0,()=>{I(u,1)}),W()}s?(e=new s(o(i)),A(e.$$.fragment),b(e.$$.fragment,1),F(e,t.parentNode,t)):e=null}else s&&e.$set(l)},i(i){r||(e&&b(e.$$.fragment,i),r=!0)},o(i){e&&y(e.$$.fragment,i),r=!1},d(i){i&&k(t),e&&I(e,i)}}}function ln(n,e,t){let r,s,o,i,a,{fragments:l}=e,{decorator:u=null}=e,{props:c={}}=e,d={};return Je("routify-fragment-context",d),n.$$set=g=>{"fragments"in g&&t(6,l=g.fragments),"decorator"in g&&t(0,u=g.decorator),"props"in g&&t(1,c=g.props)},n.$$.update=()=>{n.$$.dirty&64&&t(3,[r,...s]=[...l],r,(t(5,s),t(6,l))),n.$$.dirty&8&&t(7,{node:o,load:i,route:a}=r,o,(t(4,i),t(3,r),t(6,l)),(t(8,a),t(3,r),t(6,l))),n.$$.dirty&412&&t(2,d=Object.assign(d,{route:a,node:o,load:i,fragment:r}))},[u,c,d,r,i,s,l,o,a]}class et extends re{constructor(e){super();ne(this,e,ln,on,K,{fragments:6,decorator:0,props:1})}}function ve(n){let e,t,r,s,o,i;return t=new et({props:{fragments:n[2],decorator:n[1]}}),{c(){e=Ge("div"),A(t.$$.fragment),at(e,"display","contents")},m(a,l){P(a,e,l),F(t,e,null),s=!0,o||(i=ze(r=n[5].call(null,e)),o=!0)},p(a,l){const u={};l&4&&(u.fragments=a[2]),l&2&&(u.decorator=a[1]),t.$set(u)},i(a){s||(b(t.$$.fragment,a),s=!0)},o(a){y(t.$$.fragment,a),s=!1},d(a){a&&k(e),I(t),o=!1,i()}}}function Be(n){let e,t,r,s;return{c(){e=Ge("div")},m(o,i){P(o,e,i),r||(s=ze(t=n[0].setParentElem(e)),r=!0)},d(o){o&&k(e),r=!1,s()}}}function an(n){let e,t,r,s=n[3]&&ve(n),o=!n[0].parentElem&&Be(n);return{c(){s&&s.c(),e=it(),o&&o.c(),t=B()},m(i,a){s&&s.m(i,a),P(i,e,a),o&&o.m(i,a),P(i,t,a),r=!0},p(i,[a]){i[3]?s?(s.p(i,a),a&8&&b(s,1)):(s=ve(i),s.c(),b(s,1),s.m(e.parentNode,e)):s&&(L(),y(s,1,1,()=>{s=null}),W()),i[0].parentElem?o&&(o.d(1),o=null):o||(o=Be(i),o.c(),o.m(t.parentNode,t))},i(i){r||(b(s),r=!0)},o(i){y(s),r=!1},d(i){s&&s.d(i),i&&k(e),o&&o.d(i),i&&k(t)}}}function un(n,e,t){let r,s,o,i=E,a=()=>(i(),i=_e(r,f=>t(3,o=f)),r);n.$$.on_destroy.push(()=>i());let{router:l=null}=e,{routes:u=null}=e,{decorator:c=null}=e,{urlReflector:d=null}=e,{instance:g=null}=e,{urlRewrite:p=null}=e,{url:m=null}=e,{name:_=null}=e,{rootNode:w=null}=e,{passthrough:N=null}=e,{beforeRouterInit:R=null}=e,{afterRouterInit:X=null}=e,{beforeUrlChange:q=null}=e,{afterUrlChange:T=null}=e,{transformFragments:oe=null}=e,{onDestroy:ie=null}=e,{plugins:le=null}=e,{queryHandler:ae=null}=e;const tt=f=>{l.passthrough||(f.addEventListener("click",Ue),f.addEventListener("keydown",Ue))},Ue=f=>{const Pe=kt(f);Pe&&l.url.push(Pe)};return typeof window!="undefined"&&ut(()=>l.destroy()),n.$$set=f=>{"router"in f&&t(0,l=f.router),"routes"in f&&t(6,u=f.routes),"decorator"in f&&t(1,c=f.decorator),"urlReflector"in f&&t(7,d=f.urlReflector),"instance"in f&&t(8,g=f.instance),"urlRewrite"in f&&t(9,p=f.urlRewrite),"url"in f&&t(10,m=f.url),"name"in f&&t(11,_=f.name),"rootNode"in f&&t(12,w=f.rootNode),"passthrough"in f&&t(13,N=f.passthrough),"beforeRouterInit"in f&&t(14,R=f.beforeRouterInit),"afterRouterInit"in f&&t(15,X=f.afterRouterInit),"beforeUrlChange"in f&&t(16,q=f.beforeUrlChange),"afterUrlChange"in f&&t(17,T=f.afterUrlChange),"transformFragments"in f&&t(18,oe=f.transformFragments),"onDestroy"in f&&t(19,ie=f.onDestroy),"plugins"in f&&t(20,le=f.plugins),"queryHandler"in f&&t(21,ae=f.queryHandler)},n.$$.update=()=>{if(n.$$.dirty&4193217){const f={instance:g,rootNode:w,name:_,routes:u,urlRewrite:p,urlReflector:d,passthrough:N,beforeRouterInit:R,afterRouterInit:X,beforeUrlChange:q,afterUrlChange:T,transformFragments:oe,onDestroy:ie,plugins:le,queryHandler:ae};l?l.init(f):t(0,l=new $e(f))}n.$$.dirty&1025&&m&&m!==l.url.internal()&&l.url.replace(m),n.$$.dirty&1&&a(t(4,r=l.activeRoute)),n.$$.dirty&8&&t(2,s=(o==null?void 0:o.fragments)||[]),n.$$.dirty&5},[l,c,s,o,r,tt,u,d,g,p,m,_,w,N,R,X,q,T,oe,ie,le,ae]}class fn extends re{constructor(e){super();ne(this,e,un,an,K,{router:0,routes:6,decorator:1,urlReflector:7,instance:8,urlRewrite:9,url:10,name:11,rootNode:12,passthrough:13,beforeRouterInit:14,afterRouterInit:15,beforeUrlChange:16,afterUrlChange:17,transformFragments:18,onDestroy:19,plugins:20,queryHandler:21})}}export{fn as R,re as S,y as a,P as b,A as c,I as d,Ge as e,k as f,ne as i,F as m,E as n,K as s,b as t};
